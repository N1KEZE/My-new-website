!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.Splitting=t()}(this,function(){"use strict"
var u=document,l=u.createTextNode.bind(u)
function d(n,t,e){n.style.setProperty(t,e)}function f(n,t){return n.appendChild(t)}function p(n,t,e,r){var i=u.createElement("span")
return t&&(i.className=t),e&&(!r&&i.setAttribute("data-"+t,e),i.textContent=e),n&&f(n,i)||i}function h(n,t){return n.getAttribute("data-"+t)}function m(n,t){return n&&0!=n.length?n.nodeName?[n]:[].slice.call(n[0].nodeName?n:(t||u).querySelectorAll(n)):[]}function o(n){for(var t=[];n--;)t[n]=[]
return t}function g(n,t){n&&n.some(t)}function c(t){return function(n){return t[n]}}var s={}
function n(n,t,e,r){return{by:n,depends:t,key:e,split:r}}function e(n){return function t(e,n,r){var i=r.indexOf(e)
if(-1==i)r.unshift(e),g(s[e].depends,function(n){t(n,e,r)})
else{var u=r.indexOf(n)
r.splice(i,1),r.splice(u,0,e)}return r}(n,0,[]).map(c(s))}function t(n){s[n.by]=n}function v(n,r,i,u,o){n.normalize()
var c=[],s=document.createDocumentFragment()
u&&c.push(n.previousSibling)
var a=[]
return m(n.childNodes).some(function(n){if(!n.tagName||n.hasChildNodes()){if(n.childNodes&&n.childNodes.length)return a.push(n),void c.push.apply(c,v(n,r,i,u,o))
var t=n.wholeText||"",e=t.trim()
e.length&&(" "===t[0]&&a.push(l(" ")),g(e.split(i),function(n,t){t&&o&&a.push(p(s,"whitespace"," ",o))
var e=p(s,r,n)
c.push(e),a.push(e)})," "===t[t.length-1]&&a.push(l(" ")))}else a.push(n)}),g(a,function(n){f(s,n)}),n.innerHTML="",f(n,s),c}var a=0
var i="words",r=n(i,a,"word",function(n){return v(n,"word",/\s+/,0,1)}),y="chars",w=n(y,[i],"char",function(n,e,t){var r=[]
return g(t[i],function(n,t){r.push.apply(r,v(n,"char","",e.whitespace&&t))}),r})
function b(t){var f=(t=t||{}).key
return m(t.target||"[data-splitting]").map(function(s){var a={el:s},n=e(t.by||h(s,"splitting")||y),l=function(n,t){for(var e in t)n[e]=t[e]
return n}({},t)
return g(n,function(n){if(n.split){var t=n.by,e=(f?"-"+f:"")+n.key,r=n.split(s,l,a)
e&&(i=s,c=(o="--"+e)+"-index",g(u=r,function(n,t){Array.isArray(n)?g(n,function(n){d(n,c,t)}):d(n,c,t)}),d(i,o+"-total",u.length)),a[t]=r,s.classList.add(t)}var i,u,o,c}),s.classList.add("splitting"),a})}function N(n,t,e){var r=m(t.matching||n.children,n),i={}
return g(r,function(n){var t=Math.round(n[e])
i[t]||(i[t]=[]).push(n)}),Object.keys(i).map(Number).sort().map(c(i))}b.html=function(n){var t=(n=n||{}).target=p()
return t.innerHTML=n.content,b(n),t.outerHTML},b.add=t
var x=n("lines",[i],"line",function(n,t,e){return N(e[i],t,"offsetTop")}),T=n("items",a,"item",function(n,t){return m(t.matching||n.children,n)}),L=n("rows",a,"row",function(n,t){return N(n,t,"offsetTop")}),k=n("cols",a,"col",function(n,t){return N(n,t,"offsetLeft")}),A=n("grid",["rows","cols"]),C="layout",M=n(C,a,a,function(n,t){var e=t.rows=+(t.rows||h(n,"rows")||1),r=t.columns=+(t.columns||h(n,"columns")||1)
if(t.image=t.image||h(n,"image")||n.currentSrc||n.src,t.image){var i=m("img",n)[0]
t.image=i&&(i.currentSrc||i.src)}t.image&&d(n,"background-image","url("+t.image+")")
for(var u=e*r,o=[],c=p(a,"cell-grid");u--;){var s=p(c,"cell")
p(s,"cell-inner"),o.push(s)}return f(n,c),o}),S=n("cellRows",[C],"row",function(n,t,e){var r=t.rows,i=o(r)
return g(e[C],function(n,t,e){i[Math.floor(t/(e.length/r))].push(n)}),i}),H=n("cellColumns",[C],"col",function(n,t,e){var r=t.columns,i=o(r)
return g(e[C],function(n,t){i[t%r].push(n)}),i}),O=n("cells",["cellRows","cellColumns"],"cell",function(n,t,e){return e[C]})
return t(r),t(w),t(x),t(T),t(L),t(k),t(A),t(M),t(S),t(H),t(O),b})
